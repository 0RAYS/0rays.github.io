"use strict";(self.webpackChunkcbctf_docs=self.webpackChunkcbctf_docs||[]).push([[7586],{1911:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>d});var s=r(9729);const t={},c=s.createContext(t);function i(n){const e=s.useContext(c);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),s.createElement(c.Provider,{value:e},n.children)}},6136:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"start/quick-start","title":"\u5feb\u901f\u4e0a\u624b","description":"CBCTF \u901a\u8fc7 Kubernetes \u7684\u65b9\u5f0f\u8fdb\u884c\u90e8\u7f72\uff0c\u63a8\u8350\u4f7f\u7528 k3s \u4f5c\u4e3a\u96c6\u7fa4\u73af\u5883\u3002\u76f8\u5173\u7684\u90e8\u7f72\u7ec6\u8282\u8bf7\u53c2\u8003 \u90e8\u7f72\u3002","source":"@site/docs/start/quick-start.md","sourceDirName":"start","slug":"/start/quick-start","permalink":"/cbctf/docs/start/quick-start","draft":false,"unlisted":false,"editUrl":"https://github.com/0RAYS/CBCTF-docs/tree/master/docs/start/quick-start.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"guideSidebar","previous":{"title":"\u7b80\u4ecb","permalink":"/cbctf/docs/start/introduction"},"next":{"title":"\u529f\u80fd","permalink":"/cbctf/docs/category/\u529f\u80fd"}}');var t=r(5813),c=r(1911);const i={sidebar_position:2},d="\u5feb\u901f\u4e0a\u624b",a={},l=[{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u8fd0\u884c",id:"\u8fd0\u884c",level:2},{value:"\u521d\u59cb\u5316\u7ba1\u7406\u5458",id:"\u521d\u59cb\u5316\u7ba1\u7406\u5458",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,c.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\u5feb\u901f\u4e0a\u624b",children:"\u5feb\u901f\u4e0a\u624b"})}),"\n",(0,t.jsxs)(e.p,{children:["CBCTF \u901a\u8fc7 Kubernetes \u7684\u65b9\u5f0f\u8fdb\u884c\u90e8\u7f72\uff0c\u63a8\u8350\u4f7f\u7528 ",(0,t.jsx)(e.a,{href:"https://k3s.io/",children:"k3s"})," \u4f5c\u4e3a\u96c6\u7fa4\u73af\u5883\u3002\u76f8\u5173\u7684\u90e8\u7f72\u7ec6\u8282\u8bf7\u53c2\u8003 ",(0,t.jsx)(e.a,{href:"/cbctf/docs/depoly/",children:"\u90e8\u7f72"}),"\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u4e0b\u8f7d ",(0,t.jsx)(e.code,{children:"release\u4e8c\u8fdb\u5236\u6587\u4ef6"})," \u6216 \u514b\u9686\u524d\u540e\u7aef\u4ed3\u5e93\u5e76\u7f16\u8bd1\u3002\u6b64\u65f6\uff0c\u524d\u7aef\u5c06\u88ab\u6253\u5305\u4e3a ",(0,t.jsx)(e.code,{children:"exe"})," \u7684\u4e00\u90e8\u5206"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"git clone https://github.com/0RAYS/CBCTF-frontend.git\r\ncd CBCTF-frontend\r\npnpm install && pnpm run build\r\ncd ..\r\n\r\ngit clone https://github.com/0RAYS/CBCTF.git\r\ncp -r CBCTF-frontend/dist/* CBCTF/frontend/dist/\r\ncd CBCTF\r\ngo build\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u521d\u6b21\u8fd0\u884c\u5c06\u81ea\u52a8\u751f\u6210 ",(0,t.jsx)(e.code,{children:"config.yaml"})," \u914d\u7f6e\u6587\u4ef6\u3002\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002\u5177\u4f53\u5b57\u6bb5\u89e3\u91ca\u89c1 ",(0,t.jsx)(e.a,{href:"/cbctf/docs/depoly/settings",children:"\u914d\u7f6e"}),"\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"backend: http://127.0.0.1:8000\r\n# CORS\r\nfrontend: http://127.0.0.1:3000\r\n# Data path and NFS mount path if needed\r\npath: ./data\r\nlog:\r\n   # DEBUG INFO WARNING ERROR\r\n   level: info\r\n   save: true\r\nasynq:\r\n   # DEBUG INFO WARNING ERROR\r\n   level: warning\r\n   # Concurrent workers\r\n   concurrency: 50\r\ngin:\r\n   mode: release\r\n   host: 127.0.0.1\r\n   port: 8000\r\n   # Trusted proxy servers\r\n   proxies:\r\n      - 10.0.0.1\r\n   upload:\r\n      # Size limited\r\n      max: 8\r\n   rate:\r\n      # Global rate limit\r\n      global: 100\r\n      # Request without rate limited\r\n      whitelist:\r\n         - ::1\r\n         - 127.0.0.1\r\n   log:\r\n      # Request without logging\r\n      whitelist:\r\n         - /metrics\r\ngorm:\r\n   mysql:\r\n      host: 127.0.0.1\r\n      port: 3306\r\n      user: cbctf\r\n      pwd: password\r\n      db: cbctf\r\n      mxopen: 100\r\n      mxidle: 10\r\n   log:\r\n      # INFO WARNING ERROR SILENT\r\n      level: silent\r\nredis:\r\n   host: 127.0.0.1\r\n   port: 6379\r\n   pwd: password\r\nk8s:\r\n   # Kubeconfig path\r\n   config: ./admin.conf\r\n   # Also as prefix of resources\r\n   namespace: cbctf\r\n   # Maybe your k8s nodes cidr\r\n   # https://kubeovn.github.io/docs/stable/vpc/vpc/#_2\r\n   external_network:\r\n      cidr: 192.168.0.0/16\r\n      gateway: 192.168.0.1\r\n      interface: eth0\r\n      exclude_ips:\r\n         - 192.168.0.1\r\n         - 192.168.0.254\r\n   # Docker image\r\n   tcpdump: nicolaka/netshoot:latest\r\n   frpc:\r\n      on: false\r\n      # Docker image\r\n      image: snowdreamtech/frpc:latest\r\n      frps:\r\n         - host: example.com\r\n           port: 7000\r\n           token: token\r\n           allowed_ports:\r\n              - from: 10000\r\n                to: 30000\r\n                exclude:\r\n                   - 20000\r\n              - from: 40000\r\n                to: 60000\r\n                exclude:\r\n                   - 50000\r\n   # (len(nodes) * generator_worker) pods for each dynamic challenge\r\n   generator_worker: 2\r\nnfs:\r\n   server: 127.0.0.1\r\n   # Accessible path (RW) in NFS server\r\n   path: /mnt/data\r\n   # Gi, Mi\r\n   storage: 10Gi\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u8fd0\u884c",children:"\u8fd0\u884c"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u786e\u4fdd ",(0,t.jsx)(e.code,{children:"config.yaml"})," \u914d\u7f6e\u6b63\u786e\u540e\uff0c\u8fd0\u884c ",(0,t.jsx)(e.code,{children:"CBCTF"})," \u5bf9\u96c6\u7fa4\u8fdb\u884c\u521d\u59cb\u5316\u914d\u7f6e\uff08\u6ce8\uff1a\u5e76\u975e\u5b89\u88c5\u96c6\u7fa4\uff0c\u800c\u662f\u5bf9\u7a0b\u5e8f\u6240\u9700\u8981\u7684\u8d44\u6e90\u8fdb\u884c\u521d\u59cb\u5316\u3002\u5b89\u88c5\u96c6\u7fa4\u8bf7\u53c2\u8003 ",(0,t.jsx)(e.a,{href:"/cbctf/docs/depoly/",children:"\u90e8\u7f72"}),"\uff09\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"./CBCTF k8s init\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u6b64\u65f6\uff0c\u5c06\u4f1a\u4f9d\u636e\u914d\u7f6e\u9879\u521b\u5efa\u5bf9\u5e94\u7684 ",(0,t.jsx)(e.code,{children:"namespace"})," ",(0,t.jsx)(e.code,{children:"pv"})," ",(0,t.jsx)(e.code,{children:"pvc"})," ",(0,t.jsx)(e.code,{children:"network-attachment-define"})," \u7b49\u8d44\u6e90\uff0c\u8d44\u6e90\u540d\u79f0\u4ee5 ",(0,t.jsx)(e.code,{children:"namespace"})," \u4f5c\u4e3a\u524d\u7f00\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u6839\u636e\u4e0a\u8ff0\u547d\u4ee4\u6700\u7ec8\u7684\u8f93\u51fa\u7ed3\u679c\uff0c\u624b\u52a8\u6302\u8f7d ",(0,t.jsx)(e.code,{children:"NFS"})," \u5171\u4eab\u76ee\u5f55\u81f3\u914d\u7f6e\u9879\u4e2d\u7684 ",(0,t.jsx)(e.code,{children:"path"})," \u4f4d\u7f6e\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"sudo mount -t nfs <NFS_SERVER_IP>:/mnt/data ./data\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u542f\u52a8\u670d\u52a1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"./CBCTF\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u914d\u7f6e ",(0,t.jsx)(e.code,{children:"systemd"})," \u8fdb\u884c\u540e\u53f0\u8fd0\u884c\uff08\u53ef\u9009\uff09"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"[Unit]\r\nDescription=CBCTF Service\r\nAfter=network.target\r\n\r\n[Service]\r\nType=simple\r\nUser=user\r\nWorkingDirectory=/path/to/CBCTF\r\nExecStart=/path/to/CBCTF/CBCTF\r\nRestart=on-failure\r\nRestartSec=5s\r\n\r\n[Install]\r\nWantedBy=multi-user.target\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u542f\u52a8\u670d\u52a1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"sudo systemctl daemon-reload\r\nsudo systemctl start cbctf\r\nsudo systemctl enable cbctf\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u914d\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d ",(0,t.jsx)(e.code,{children:"NFS"})," \u5171\u4eab\u76ee\u5f55\uff08\u53ef\u9009\uff09"]}),"\n",(0,t.jsxs)(e.p,{children:["\u7f16\u8f91 ",(0,t.jsx)(e.code,{children:"/etc/fstab"})," \u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"<NFS_SERVER_IP>:/mnt/data /path/to/CBCTF/data nfs defaults 0 0\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u521d\u59cb\u5316\u7ba1\u7406\u5458",children:"\u521d\u59cb\u5316\u7ba1\u7406\u5458"}),"\n",(0,t.jsxs)(e.p,{children:["\u5f53\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u7ba1\u7406\u5458\u7528\u6237\u65f6\uff0c\u8fd0\u884c\u670d\u52a1\u5c06\u4f1a\u81ea\u52a8\u8fdb\u884c\u521d\u59cb\u5316\u7ba1\u7406\u5458\u7528\u6237\uff0c\u76f8\u5173\u8d26\u53f7\u5bc6\u7801\u5c06\u4f1a\u6253\u5370\u5728\u65e5\u5fd7\u4e2d\uff0c\u8bf7\u53ca\u65f6\u8fdb\u884c\u4fee\u6539\uff0c\u7ba1\u7406\u5458\u767b\u5f55\u5730\u5740\u4e3a ",(0,t.jsx)(e.code,{children:"https://host/platform/#/admin/login"}),"\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-log",children:"Init Admin: Admin{ name: admin, password: [uuid], email: admin@0rays.club}\n"})})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}}}]);