import{j as r,m as d,a as m}from"./index-3olWmlYE.js";import{E as h}from"./index-DHqPsdHK.js";import{g as p}from"./system-BbynrEM0.js";function s({status:e,chartContent:a,extraContent:c}){const n=o=>{if(!o&&o!==0)return"N/A";if(o===0)return"0 B";const l=1024,t=["B","KB","MB","GB","TB"],x=Math.floor(Math.log(o)/Math.log(l));return parseFloat((o/Math.pow(l,x)).toFixed(2))+" "+t[x]},i=({title:o,value:l,valueColor:t="text-geek-400"})=>r.jsxs(d.div,{className:"border border-neutral-300/30 rounded-md bg-black/30 backdrop-blur-[2px] p-4",whileHover:{y:-2,boxShadow:"0 4px 20px rgba(89, 126, 247, 0.1)"},transition:{duration:.2},children:[r.jsx("h2",{className:"text-sm font-mono text-neutral-400 mb-2",children:o}),r.jsx("p",{className:`text-2xl ${t}`,children:l})]});return r.jsxs("div",{className:"w-full max-w-[1200px] mx-auto space-y-6",children:[r.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h1",{className:"text-3xl font-mono text-neutral-50",children:"系统状态"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 animate-pulse"}),r.jsx("span",{className:"text-neutral-400 text-sm",children:"实时监控"})]})]}),a&&r.jsx("div",{className:"mb-5 border border-neutral-300/30 rounded-md bg-black/40",children:a}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[r.jsx(i,{title:"服务器 IP",value:(e==null?void 0:e.ip)||"N/A"}),r.jsx(i,{title:"用户数量",value:(e==null?void 0:e.users)||0}),r.jsx(i,{title:"赛事数量",value:(e==null?void 0:e.contests)||0}),r.jsx(i,{title:"题目数量",value:(e==null?void 0:e.challenges)||0}),r.jsx(i,{title:"请求数量",value:(e==null?void 0:e.requests)||0}),r.jsx(i,{title:"平均响应",value:e!=null&&e.duration?`${e.duration} ms`:"N/A"}),r.jsx(i,{title:"下行流量",value:n(e==null?void 0:e.sent)}),r.jsx(i,{title:"上行流量",value:n(e==null?void 0:e.recv)}),r.jsx(i,{title:"总流量",value:n(e==null?void 0:e.io)}),r.jsx(i,{title:"缓存总量",value:(e==null?void 0:e.cache)||0}),r.jsx(i,{title:"命中数",value:(e==null?void 0:e.hit)||0}),r.jsx(i,{title:"命中率",value:e!=null&&e.rate?`${e.rate}%`:"N/A",valueColor:"text-yellow-400"})]})]}),c&&r.jsx(d.div,{className:"border border-neutral-300 rounded-md bg-black/30 backdrop-blur-[2px] p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:c})]})}function v(){const[e,a]=m.useState(null),[c,n]=m.useState("");m.useEffect(()=>{i().then();const l=setInterval(()=>{i().then()},3e3);return()=>{clearInterval(l)}},[]);const i=async()=>{try{const l=await p(!0);l.code===200?a(l.data):n(l.msg||"获取系统状态失败")}catch(l){n("获取系统状态失败"),console.error(l)}},o=()=>e!=null&&e.metrics?{grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:{type:"category",data:e.metrics.map(l=>new Date(l.timestamp).toLocaleTimeString()),axisLine:{lineStyle:{color:"#ccc"}},axisLabel:{color:"#666"},splitLine:{show:!0,lineStyle:{color:"#e0e0e0",type:"dashed",width:1}}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#ccc"}},axisLabel:{color:"#666"},splitLine:{show:!0,lineStyle:{color:"#e0e0e0",type:"dashed",width:1}}},series:[{name:"CPU Usage (%)",type:"line",data:e.metrics.map(l=>l.cpu),smooth:!0,lineStyle:{color:"#8884d8"},itemStyle:{color:"#8884d8"},symbol:"none"},{name:"Memory Usage (%)",type:"line",data:e.metrics.map(l=>l.mem),smooth:!0,lineStyle:{color:"#82ca9d"},itemStyle:{color:"#82ca9d"},symbol:"none"},{name:"Disk Usage (%)",type:"line",data:e.metrics.map(l=>l.disk),smooth:!0,lineStyle:{color:"#ffc658"},itemStyle:{color:"#ffc658"},symbol:"none"}]}:{};return c?r.jsx("div",{className:"p-4 text-red-500",children:c}):r.jsx("div",{className:"p-4",children:r.jsx(s,{status:e,chartContent:r.jsx("div",{style:{width:"100%",height:"450px"},children:r.jsx(h,{option:o(),style:{height:"100%",width:"100%"}})})})})}export{v as default};
