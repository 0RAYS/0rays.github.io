import{u as h,b as m,g as p,a as c,f,t as o,j as e,m as j}from"./index-D2Yzijmo.js";function w(){const r=h(),l=m(),[a]=p(),[i,s]=c.useState("processing");c.useEffect(()=>{u()},[]);const u=async()=>{try{s("processing");const t=a.get("token"),n=a.get("error");if(n)throw new Error(`OAuth登录失败: ${n}`);if(!t)throw new Error("OAuth token缺失");localStorage.setItem("token","Bearer "+t),localStorage.setItem("userType","user"),console.log(localStorage),await new Promise(x=>setTimeout(x,500)),await l(f()),s("success"),o.success({description:"OAuth登录成功"}),r("/games")}catch(t){console.error("OAuth回调处理失败:",t),s("error"),o.danger({description:t.message||"OAuth登录失败"}),setTimeout(()=>{r("/login")},2e3)}},d=()=>{switch(i){case"processing":return e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-geek-400"}),e.jsx("p",{className:"text-neutral-300 text-lg",children:"正在处理OAuth登录..."}),e.jsx("p",{className:"text-neutral-400 text-sm",children:"请稍候，正在验证您的身份"})]});case"success":return e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-neutral-300 text-lg",children:"登录成功！"}),e.jsx("p",{className:"text-neutral-400 text-sm",children:"正在跳转..."})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("p",{className:"text-neutral-300 text-lg",children:"登录失败"}),e.jsx("p",{className:"text-neutral-400 text-sm",children:"正在返回登录页面..."})]});default:return null}};return e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-190px)]",children:e.jsx(j.div,{className:"w-[400px] bg-black/40 backdrop-blur-[2px] border border-neutral-300 rounded-md p-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:d()})})}export{w as default};
